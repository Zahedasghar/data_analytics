<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Learn Basics of Data Analysis using R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="gapminder_files/libs/clipboard/clipboard.min.js"></script>
<script src="gapminder_files/libs/quarto-html/quarto.js"></script>
<script src="gapminder_files/libs/quarto-html/popper.min.js"></script>
<script src="gapminder_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="gapminder_files/libs/quarto-html/anchor.min.js"></script>
<link href="gapminder_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="gapminder_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="gapminder_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="gapminder_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="gapminder_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">

<script src="gapminder_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="gapminder_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Learn Basics of Data Analysis using R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="https://gordianknotbio.com/wp-content/uploads/2019/01/bubble-chart.png" class="img-fluid"></p>
<section id="why-r" class="level1">
<h1>Why R</h1>
<p>There is an increasing recognition of reproducibility of research, though it has limited recognition in social sciences. The document in your hand is written in <code>Quarto Markdown</code>. <code>Quarto Markown</code> which can be used for pdf, html, word, PowerPoint/Slidy/Beamer Presentations, Webpages, LaTex and many others. Besides learning basics of R-coding, another objective of this workshop is understanding the importance of reproducibility. Building this new habit of reproducible work at times maybe little challenging occasionally. Getting rid of culture of copying and pasting, and sparing this time for doing data analysis and research is one of the objectives of this or coming workshops. Purpose is to help you to get away from this tedious activity so that you can spend more time <strong>doing science</strong>.</p>
<section id="installing-and-loading-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-and-loading-packages">Installing and loading packages</h2>
<p>The first thing we need to do is install and then load the <code>tidyverse</code> set of R packages to provide us with lots of extra functionality. You only need to install this once: once it’s installed we can simply load it into the workspace using the library() function each time we open a new R session.</p>
<p>Understanding data sets requires many hours/days or in some cases weeks.There are many commercially available software but open source community based software have now dominated and R is one of these. R makes data understanding process as easy as possible through the <code>dplyr</code> package. It is one of the easiest solution for code-based data analysis. We will learn in this training how to do it. In case, you need more information, you can watch my <a href="https://youtu.be/ZNBZevfYgo0">videos</a>.</p>
<p>I have discussed the <a href="https://cran.r-project.org/web/packages/gapminder/index.html">Gapminder dataset</a> in my videos and we shall use it throughout this training. It’s available through CRAN, so make sure to install it. Here’s how to load in all required packages:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> country </th>
   <th style="text-align:left;"> continent </th>
   <th style="text-align:right;"> year </th>
   <th style="text-align:right;"> lifeExp </th>
   <th style="text-align:right;"> pop </th>
   <th style="text-align:right;"> gdpPercap </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1952 </td>
   <td style="text-align:right;"> 71.86 </td>
   <td style="text-align:right;"> 7124673 </td>
   <td style="text-align:right;"> 8528 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1957 </td>
   <td style="text-align:right;"> 72.49 </td>
   <td style="text-align:right;"> 7363802 </td>
   <td style="text-align:right;"> 9912 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1962 </td>
   <td style="text-align:right;"> 73.37 </td>
   <td style="text-align:right;"> 7561588 </td>
   <td style="text-align:right;"> 12329 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1967 </td>
   <td style="text-align:right;"> 74.16 </td>
   <td style="text-align:right;"> 7867931 </td>
   <td style="text-align:right;"> 15258 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1972 </td>
   <td style="text-align:right;"> 74.72 </td>
   <td style="text-align:right;"> 8122293 </td>
   <td style="text-align:right;"> 17832 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1977 </td>
   <td style="text-align:right;"> 75.44 </td>
   <td style="text-align:right;"> 8251648 </td>
   <td style="text-align:right;"> 18856 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1982 </td>
   <td style="text-align:right;"> 76.42 </td>
   <td style="text-align:right;"> 8325260 </td>
   <td style="text-align:right;"> 20667 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1987 </td>
   <td style="text-align:right;"> 77.19 </td>
   <td style="text-align:right;"> 8421403 </td>
   <td style="text-align:right;"> 23587 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1992 </td>
   <td style="text-align:right;"> 78.16 </td>
   <td style="text-align:right;"> 8718867 </td>
   <td style="text-align:right;"> 23880 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 1997 </td>
   <td style="text-align:right;"> 79.39 </td>
   <td style="text-align:right;"> 8897619 </td>
   <td style="text-align:right;"> 25267 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 2002 </td>
   <td style="text-align:right;"> 80.04 </td>
   <td style="text-align:right;"> 8954175 </td>
   <td style="text-align:right;"> 29342 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sweden </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 80.88 </td>
   <td style="text-align:right;"> 9031088 </td>
   <td style="text-align:right;"> 33860 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>First few rows of data are displayed here and there 1704 observations in total. In this training, some very basic but important things you will learn are</p>
</section>
</section>
<section id="key-components-of-handling-data" class="level1">
<h1>Key components of handling data</h1>
<ul>
<li>View, glimpse, structure</li>
<li>head, tail</li>
<li>Column Selection</li>
<li>Data Filtering</li>
<li>Data Ordering</li>
<li>Creating Derived Columns</li>
<li>Calculating Summary Statistics</li>
<li>Grouping</li>
</ul>
<section id="information-in-gapminder-data" class="level2">
<h2 class="anchored" data-anchor-id="information-in-gapminder-data">Information in <strong>gapminder</strong> data</h2>
<p><code>View</code> command opens data in new worksheet while glimpse lists nature of variables (numeric/character/factor…) and total number of rows and columns.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 6
$ country   &lt;fct&gt; "Afghanistan", "Afghanistan", "Afghanistan", "Afghanistan", …
$ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
$ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …
$ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
$ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 12…
$ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        country        continent        year         lifeExp     
 Afghanistan:  12   Africa  :624   Min.   :1952   Min.   :23.60  
 Albania    :  12   Americas:300   1st Qu.:1966   1st Qu.:48.20  
 Algeria    :  12   Asia    :396   Median :1980   Median :60.71  
 Angola     :  12   Europe  :360   Mean   :1980   Mean   :59.47  
 Argentina  :  12   Oceania : 24   3rd Qu.:1993   3rd Qu.:70.85  
 Australia  :  12                  Max.   :2007   Max.   :82.60  
 (Other)    :1632                                                
      pop              gdpPercap       
 Min.   :6.001e+04   Min.   :   241.2  
 1st Qu.:2.794e+06   1st Qu.:  1202.1  
 Median :7.024e+06   Median :  3531.8  
 Mean   :2.960e+07   Mean   :  7215.3  
 3rd Qu.:1.959e+07   3rd Qu.:  9325.5  
 Max.   :1.319e+09   Max.   :113523.1  
                                       </code></pre>
</div>
</div>
</section>
</section>
<section id="dplyr-features" class="level1">
<h1>dplyr features</h1>
<ol type="1">
<li><code>filter()</code> to keep selected observations</li>
<li><code>select()</code> to keep selected variables</li>
<li><code>arrange()</code> to reorder observations by a value</li>
<li><code>mutate()</code> to create new variables</li>
<li><code>summarize()</code> to create summary statistics</li>
<li><code>group_by()</code> for performing operations by group</li>
</ol>
<p>Now I shall mention some of the powerful but very simple to use features of dplyr. ## Column Selection</p>
<p>More often than not, you don’t need all columns of a data set for your analysis. For example <code>PDHS</code> files have more than 5000 columns in some files and maybe 40 or 50 or even fewer than that are needed for your analysis. <code>Select()</code> function of R’s dplyr is used to select columns of your interest Three selected columns are selected as follows. You can give new name to this data.</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> country </th>
   <th style="text-align:right;"> pop </th>
   <th style="text-align:right;"> lifeExp </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:right;"> 8425333 </td>
   <td style="text-align:right;"> 28.801 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:right;"> 9240934 </td>
   <td style="text-align:right;"> 30.332 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:right;"> 10267083 </td>
   <td style="text-align:right;"> 31.997 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:right;"> 11537966 </td>
   <td style="text-align:right;"> 34.020 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:right;"> 13079460 </td>
   <td style="text-align:right;"> 36.088 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:right;"> 14880372 </td>
   <td style="text-align:right;"> 38.438 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>In case you want to select most of the variables and drop one or two, you may proceed as follows</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 5
   country     continent  year lifeExp      pop
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;
 1 Afghanistan Asia       1952    28.8  8425333
 2 Afghanistan Asia       1957    30.3  9240934
 3 Afghanistan Asia       1962    32.0 10267083
 4 Afghanistan Asia       1967    34.0 11537966
 5 Afghanistan Asia       1972    36.1 13079460
 6 Afghanistan Asia       1977    38.4 14880372
 7 Afghanistan Asia       1982    39.9 12881816
 8 Afghanistan Asia       1987    40.8 13867957
 9 Afghanistan Asia       1992    41.7 16317921
10 Afghanistan Asia       1997    41.8 22227415
# … with 1,694 more rows</code></pre>
</div>
</div>
<p>So <code>gdpPerCapita</code> column is now not shown above.</p>
<section id="data-filtering" class="level2">
<h2 class="anchored" data-anchor-id="data-filtering">Data Filtering</h2>
<p>Filtering is another very important task one has to do in one’s analysis. Sometimes, one has to select sale related to a particular city or agent or quarter. Here is how one uses <code>filter()</code> command for data with a condition. We are using here command only to select data for year 2007 for all the countries. I am going to explain <code>filter</code> variable of dplyr. <code>filter</code> is used only to select rows for a given condition. I am going to select data only for year 2007.</p>
<div class="cell">
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> country </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> continent </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> year </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> lifeExp </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> pop </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> gdpPercap </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:left;"> Asia </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 43.828 </td>
   <td style="text-align:right;"> 31889923 </td>
   <td style="text-align:right;"> 974.5803 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Albania </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 76.423 </td>
   <td style="text-align:right;"> 3600523 </td>
   <td style="text-align:right;"> 5937.0295 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Algeria </td>
   <td style="text-align:left;"> Africa </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 72.301 </td>
   <td style="text-align:right;"> 33333216 </td>
   <td style="text-align:right;"> 6223.3675 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Angola </td>
   <td style="text-align:left;"> Africa </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 42.731 </td>
   <td style="text-align:right;"> 12420476 </td>
   <td style="text-align:right;"> 4797.2313 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Argentina </td>
   <td style="text-align:left;"> Americas </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 75.320 </td>
   <td style="text-align:right;"> 40301927 </td>
   <td style="text-align:right;"> 12779.3796 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Australia </td>
   <td style="text-align:left;"> Oceania </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 81.235 </td>
   <td style="text-align:right;"> 20434176 </td>
   <td style="text-align:right;"> 34435.3674 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Austria </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 79.829 </td>
   <td style="text-align:right;"> 8199783 </td>
   <td style="text-align:right;"> 36126.4927 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bahrain </td>
   <td style="text-align:left;"> Asia </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 75.635 </td>
   <td style="text-align:right;"> 708573 </td>
   <td style="text-align:right;"> 29796.0483 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bangladesh </td>
   <td style="text-align:left;"> Asia </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 64.062 </td>
   <td style="text-align:right;"> 150448339 </td>
   <td style="text-align:right;"> 1391.2538 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Belgium </td>
   <td style="text-align:left;"> Europe </td>
   <td style="text-align:right;"> 2007 </td>
   <td style="text-align:right;"> 79.441 </td>
   <td style="text-align:right;"> 10392226 </td>
   <td style="text-align:right;"> 33692.6051 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Compared to previous one, <code>gapminder</code> is showing data only for 142 rows. Pipes %&gt;% play very nicely with dplyr and make our code very easy to understand. The tibble gapminder is being piped into the function <code>filter()</code>. The argument <code>year == 2007</code> tells filter() that it should find all the rows such that the logical condition <code>year == 2007</code> is TRUE.</p>
<p><code>Have we accidently deleted all other rows? Answer is no.</code></p>
<p>Nope: we haven’t made any changes to gapminder at all. If you don’t believe me try entering gapminder at the console. All that this command does is display a subset of gapminder. If we wanted to store the result of running this command, we’d need to assign it to a variable, for example if you are not sure, lets type</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 6
   country     continent  year lifeExp       pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       2007    43.8  31889923      975.
 2 Albania     Europe     2007    76.4   3600523     5937.
 3 Algeria     Africa     2007    72.3  33333216     6223.
 4 Angola      Africa     2007    42.7  12420476     4797.
 5 Argentina   Americas   2007    75.3  40301927    12779.
 6 Australia   Oceania    2007    81.2  20434176    34435.
 7 Austria     Europe     2007    79.8   8199783    36126.
 8 Bahrain     Asia       2007    75.6    708573    29796.
 9 Bangladesh  Asia       2007    64.1 150448339     1391.
10 Belgium     Europe     2007    79.4  10392226    33693.
# … with 132 more rows</code></pre>
</div>
</div>
</section>
<section id="filtering-with-respect-to-two-variables" class="level2">
<h2 class="anchored" data-anchor-id="filtering-with-respect-to-two-variables">Filtering with respect to two variables</h2>
<p>One can apply multiple <code>filters</code></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  country   continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;     &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Sri Lanka Asia       2007    72.4 20378239     3970.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  country  continent  year lifeExp       pop gdpPercap
  &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
1 Pakistan Asia       2007    65.5 169270617     2606.</code></pre>
</div>
</div>
<p>Now we are selecting multiple countries for year 2007.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  country     continent  year lifeExp        pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;      &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       2007    43.8   31889923      975.
2 Bangladesh  Asia       2007    64.1  150448339     1391.
3 India       Asia       2007    64.7 1110396331     2452.
4 Iran        Asia       2007    71.0   69453570    11606.
5 Pakistan    Asia       2007    65.5  169270617     2606.</code></pre>
</div>
</div>
</section>
<section id="filtering-data-for-south-asia-countries" class="level2">
<h2 class="anchored" data-anchor-id="filtering-data-for-south-asia-countries">Filtering data for South Asia countries</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# … with 62 more rows</code></pre>
</div>
</div>
</section>
<section id="sort-data-with-arrange" class="level2">
<h2 class="anchored" data-anchor-id="sort-data-with-arrange">Sort data with <code>arrange</code></h2>
<p>Sort data with arrange Suppose we wanted to sort gapminder data for South Asia by gdpPercap. To do this we can use the arrange command along with the pipe %&gt;% as follows:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 6
   country     continent  year lifeExp       pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
 1 Nepal       Asia       1952    36.2   9182536      546.
 2 India       Asia       1952    37.4 372000000      547.
 3 India       Asia       1957    40.2 409000000      590.
 4 Nepal       Asia       1957    37.7   9682338      598.
 5 Bangladesh  Asia       1972    45.3  70759295      630.
 6 Afghanistan Asia       1997    41.8  22227415      635.
 7 Afghanistan Asia       1992    41.7  16317921      649.
 8 Nepal       Asia       1962    39.4  10332057      652.
 9 India       Asia       1962    43.6 454000000      658.
10 Bangladesh  Asia       1977    46.9  80428306      660.
# … with 62 more rows</code></pre>
</div>
</div>
<p>The logic is very similar to what we saw above for filter. Here, I use another important function <code>arrange</code>. The argument <code>gdpPercap</code> tells <code>arrange()</code> that we want to sort by GDP per capita. Note that by default <code>arrange()</code> sorts in ascending order. If we want to sort in descending order, we use the function <code>desc()</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 6
   country   continent  year lifeExp        pop gdpPercap
   &lt;fct&gt;     &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;      &lt;int&gt;     &lt;dbl&gt;
 1 Sri Lanka Asia       2007    72.4   20378239     3970.
 2 Sri Lanka Asia       2002    70.8   19576783     3015.
 3 Sri Lanka Asia       1997    70.5   18698655     2664.
 4 Pakistan  Asia       2007    65.5  169270617     2606.
 5 India     Asia       2007    64.7 1110396331     2452.
 6 Sri Lanka Asia       1992    70.4   17587060     2154.
 7 Pakistan  Asia       2002    63.6  153403524     2093.
 8 Pakistan  Asia       1997    61.8  135564834     2049.
 9 Pakistan  Asia       1992    60.8  120065004     1972.
10 Sri Lanka Asia       1987    69.0   16495304     1877.
# … with 62 more rows</code></pre>
</div>
</div>
</section>
<section id="life-expectancy-in-south-asia-in-2007" class="level2">
<h2 class="anchored" data-anchor-id="life-expectancy-in-south-asia-in-2007">Life Expectancy in South Asia in 2007</h2>
<p>What is the lowest and highest life expectancy among South Asian countries?</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  country     continent  year lifeExp        pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;      &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       2007    43.8   31889923      975.
2 Nepal       Asia       2007    63.8   28901790     1091.
3 Bangladesh  Asia       2007    64.1  150448339     1391.
4 India       Asia       2007    64.7 1110396331     2452.
5 Pakistan    Asia       2007    65.5  169270617     2606.
6 Sri Lanka   Asia       2007    72.4   20378239     3970.</code></pre>
</div>
</div>
</section>
<section id="change-an-existing-variable-or-create-a-new-one-with-mutate" class="level2">
<h2 class="anchored" data-anchor-id="change-an-existing-variable-or-create-a-new-one-with-mutate">Change an existing variable or create a new one with mutate</h2>
<p>It’s a little hard to read the column pop in gapminder since there are so many digits. Suppose that, instead of raw population, we wanted to display population in millions. This requires us to pop by 1000000, which we can do using the function <code>mutate()</code> from dplyr as follows:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 6
   country     continent  year lifeExp   pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8.43      779.
 2 Afghanistan Asia       1957    30.3  9.24      821.
 3 Afghanistan Asia       1962    32.0 10.3       853.
 4 Afghanistan Asia       1967    34.0 11.5       836.
 5 Afghanistan Asia       1972    36.1 13.1       740.
 6 Afghanistan Asia       1977    38.4 14.9       786.
 7 Afghanistan Asia       1982    39.9 12.9       978.
 8 Afghanistan Asia       1987    40.8 13.9       852.
 9 Afghanistan Asia       1992    41.7 16.3       649.
10 Afghanistan Asia       1997    41.8 22.2       635.
# … with 62 more rows</code></pre>
</div>
</div>
<p>If we want to calculate GDP, we need to multiply gdpPercap by pop.</p>
<pre><code>But wait! Didn't we just change pop so it's expressed in millions? </code></pre>
<p>No: we never stored the results of our previous command, we simply displayed them. Just as I discussed above, unless you overwrite it, the original gapminder dataset will be unchanged. With this in mind, we can create the gdp variable as follows:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 7
   country     continent  year lifeExp      pop gdpPercap          gdp
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;        &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.  6567086330.
 2 Afghanistan Asia       1957    30.3  9240934      821.  7585448670.
 3 Afghanistan Asia       1962    32.0 10267083      853.  8758855797.
 4 Afghanistan Asia       1967    34.0 11537966      836.  9648014150.
 5 Afghanistan Asia       1972    36.1 13079460      740.  9678553274.
 6 Afghanistan Asia       1977    38.4 14880372      786. 11697659231.
 7 Afghanistan Asia       1982    39.9 12881816      978. 12598563401.
 8 Afghanistan Asia       1987    40.8 13867957      852. 11820990309.
 9 Afghanistan Asia       1992    41.7 16317921      649. 10595901589.
10 Afghanistan Asia       1997    41.8 22227415      635. 14121995875.
# … with 62 more rows</code></pre>
</div>
</div>
</section>
<section id="how-to-calculate-new-variables" class="level2">
<h2 class="anchored" data-anchor-id="how-to-calculate-new-variables">How to calculate new variables</h2>
<p>As mentioned above, <code>mutate</code> is used to calculate new variable. Here we have calculated a new variable <code>gdp</code> and then <code>arranged</code> data and selected <code>top_n(10)</code> countries to see whether higher <code>lifeExpectancy</code> and higher <code>gdp</code> are linked or not?</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
   country        continent  year lifeExp        pop gdpPercap     gdp
   &lt;fct&gt;          &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;      &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 United States  Americas   2007    78.2  301139947    42952. 1.29e13
 2 China          Asia       2007    73.0 1318683096     4959. 6.54e12
 3 Japan          Asia       2007    82.6  127467972    31656. 4.04e12
 4 India          Asia       2007    64.7 1110396331     2452. 2.72e12
 5 Germany        Europe     2007    79.4   82400996    32170. 2.65e12
 6 United Kingdom Europe     2007    79.4   60776238    33203. 2.02e12
 7 France         Europe     2007    80.7   61083916    30470. 1.86e12
 8 Brazil         Americas   2007    72.4  190010647     9066. 1.72e12
 9 Italy          Europe     2007    80.5   58147733    28570. 1.66e12
10 Mexico         Americas   2007    76.2  108700891    11978. 1.30e12</code></pre>
</div>
</div>
<p><code>transmute()</code> keeps only the derived column. Let’s use it in the example from above:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
       gdp
     &lt;dbl&gt;
 1 1.29e13
 2 6.54e12
 3 4.04e12
 4 2.72e12
 5 2.65e12
 6 2.02e12
 7 1.86e12
 8 1.72e12
 9 1.66e12
10 1.30e12</code></pre>
</div>
</div>
</section>
<section id="ordering" class="level2">
<h2 class="anchored" data-anchor-id="ordering">Ordering</h2>
<p>If one wants to have ordered data with respect to specific column(s), <code>arrange()</code> function is used in dplyr. To arrange data by life expectancy, we use <code>arrange()</code> function</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
   country                   year lifeExp
   &lt;fct&gt;                    &lt;int&gt;   &lt;dbl&gt;
 1 Swaziland                 2007    39.6
 2 Mozambique                2007    42.1
 3 Zambia                    2007    42.4
 4 Sierra Leone              2007    42.6
 5 Lesotho                   2007    42.6
 6 Angola                    2007    42.7
 7 Zimbabwe                  2007    43.5
 8 Afghanistan               2007    43.8
 9 Central African Republic  2007    44.7
10 Liberia                   2007    45.7
# … with 132 more rows</code></pre>
</div>
</div>
<p>If one wants order from top to bottom, then use <code>arrange(desc())</code> command as follows:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
   country           year lifeExp
   &lt;fct&gt;            &lt;int&gt;   &lt;dbl&gt;
 1 Japan             2007    82.6
 2 Hong Kong, China  2007    82.2
 3 Iceland           2007    81.8
 4 Switzerland       2007    81.7
 5 Australia         2007    81.2
 6 Spain             2007    80.9
 7 Sweden            2007    80.9
 8 Israel            2007    80.7
 9 France            2007    80.7
10 Canada            2007    80.7
# … with 132 more rows</code></pre>
</div>
</div>
<p>If one wants that only top 5 or bottom 5 rows are returned. One may use</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  country           year lifeExp
  &lt;fct&gt;            &lt;int&gt;   &lt;dbl&gt;
1 Japan             2007    82.6
2 Hong Kong, China  2007    82.2
3 Iceland           2007    81.8
4 Switzerland       2007    81.7
5 Australia         2007    81.2</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   country           year lifeExp
   &lt;fct&gt;            &lt;int&gt;   &lt;dbl&gt;
 1 Canada            2007    80.7
 2 France            2007    80.7
 3 Israel            2007    80.7
 4 Sweden            2007    80.9
 5 Spain             2007    80.9
 6 Australia         2007    81.2
 7 Switzerland       2007    81.7
 8 Iceland           2007    81.8
 9 Hong Kong, China  2007    82.2
10 Japan             2007    82.6</code></pre>
</div>
</div>
</section>
</section>
<section id="summarising-data" class="level1">
<h1>Summarising data</h1>
<p>Another feature of dplyr is <code>summarise</code> data</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  continent  mean   min   max
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Africa     54.8  39.6  76.4
2 Americas   73.6  60.9  80.7
3 Asia       70.7  43.8  82.6
4 Europe     77.6  71.8  81.8
5 Oceania    80.7  80.2  81.2</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  avglifeExp
       &lt;dbl&gt;
1       59.5</code></pre>
</div>
</div>
<section id="summarising-data-by-groups" class="level2">
<h2 class="anchored" data-anchor-id="summarising-data-by-groups">Summarising data by groups</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  avgLifeExp
       &lt;dbl&gt;
1       70.7</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent avglife
  &lt;fct&gt;       &lt;dbl&gt;
1 Africa       54.8
2 Americas     73.6
3 Asia         70.7
4 Europe       77.6
5 Oceania      80.7</code></pre>
</div>
</div>
</section>
<section id="if_else-command-alongwith-mutate" class="level2">
<h2 class="anchored" data-anchor-id="if_else-command-alongwith-mutate">if_else command alongwith mutate</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  continent avgLifeExp over75
  &lt;fct&gt;          &lt;dbl&gt; &lt;chr&gt; 
1 Africa          54.8 N     
2 Americas        73.6 Y     
3 Asia            70.7 Y     
4 Europe          77.6 Y     
5 Oceania         80.7 Y     </code></pre>
</div>
</div>
</section>
<section id="total-population-by-continets-in-2007" class="level2">
<h2 class="anchored" data-anchor-id="total-population-by-continets-in-2007">Total Population by Continets in 2007</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent    tot_pop
  &lt;fct&gt;          &lt;dbl&gt;
1 Africa     929539692
2 Americas   898871184
3 Asia      3811953827
4 Europe     586098529
5 Oceania     24549947</code></pre>
</div>
</div>
</section>
<section id="percentiles" class="level2">
<h2 class="anchored" data-anchor-id="percentiles">Percentiles</h2>
<p>In general it is assumed that higher the GDP , higher the lifeExp. To test this assumption, lets calculate percentiles of lifeExp. This will indicate how many countries have ranking lower than the current country.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 5
   country           year lifeExp gdpPercap percentile
   &lt;fct&gt;            &lt;int&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;int&gt;
 1 Norway            2007    80.2    49357.         88
 2 Kuwait            2007    77.6    47307.         68
 3 Singapore         2007    80.0    47143.         87
 4 United States     2007    78.2    42952.         71
 5 Ireland           2007    78.9    40676.         79
 6 Hong Kong, China  2007    82.2    39725.         99
 7 Switzerland       2007    81.7    37506.         97
 8 Netherlands       2007    79.8    36798.         85
 9 Canada            2007    80.7    36319.         91
10 Iceland           2007    81.8    36181.         98
# … with 132 more rows</code></pre>
</div>
</div>
<p>One can notice that all countries are well above 60th percentile on lifeExpectancy when arranged by GDP per capita.</p>
<p>Before you conclude, lets see the bottom side</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 5
   country                   year lifeExp gdpPercap percentile
   &lt;fct&gt;                    &lt;int&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;int&gt;
 1 Congo, Dem. Rep.          2007    46.5      278.          7
 2 Liberia                   2007    45.7      415.          5
 3 Burundi                   2007    49.6      430.         10
 4 Zimbabwe                  2007    43.5      470.          4
 5 Guinea-Bissau             2007    46.4      579.          6
 6 Niger                     2007    56.9      620.         18
 7 Eritrea                   2007    58.0      641.         19
 8 Ethiopia                  2007    52.9      691.         14
 9 Central African Republic  2007    44.7      706.          5
10 Gambia                    2007    59.4      753.         21
# … with 132 more rows</code></pre>
</div>
</div>
<p>So it makes sense that higher the GDP, higher the lifeExp. This is not formal testing but exploratory data makes lot of sense here.</p>
</section>
</section>
<section id="advanced-analysis" class="level1">
<h1>Advanced Analysis</h1>
<p>Filtering data as done in introductory analysis seems quite difficult if you are not familiar with these simple things. But if you are working with dplyr for quite sometime, there is not anything very advanced or difficult.</p>
<p>For example, let’s say you have to find out the top 10 countries in the 90th percentile regarding life expectancy in 2007. You can reuse some of the logic from the previous sections, but answering this question alone requires <code>multiple filtering</code> and <code>subsetting</code>:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   country          continent lifeExp gdpPercap
   &lt;fct&gt;            &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Japan            Asia         82.6    31656.
 2 Hong Kong, China Asia         82.2    39725.
 3 Iceland          Europe       81.8    36181.
 4 Switzerland      Europe       81.7    37506.
 5 Australia        Oceania      81.2    34435.
 6 Spain            Europe       80.9    28821.
 7 Sweden           Europe       80.9    33860.
 8 Israel           Asia         80.7    25523.
 9 France           Europe       80.7    30470.
10 Canada           Americas     80.7    36319.</code></pre>
</div>
</div>
<p>In case you are interested in bottom 10 (worst lifeExp countries from the bottom), use <code>top_n</code> with <code>-10</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   country                  continent lifeExp gdpPercap
   &lt;fct&gt;                    &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Mozambique               Africa       42.1      824.
 2 Swaziland                Africa       39.6     4513.
 3 Sierra Leone             Africa       42.6      863.
 4 Zambia                   Africa       42.4     1271.
 5 Angola                   Africa       42.7     4797.
 6 Lesotho                  Africa       42.6     1569.
 7 Afghanistan              Asia         43.8      975.
 8 Zimbabwe                 Africa       43.5      470.
 9 Central African Republic Africa       44.7      706.
10 Liberia                  Africa       45.7      415.</code></pre>
</div>
</div>
</section>
<section id="visualizing-data-to-get-data-insight" class="level1">
<h1>Visualizing data to get data insight</h1>
<p>Visualizing data is one of the most important aspect of getting data insight and may provide a better data insight than a complicated model. Visualizing large data sets were not an easy task, so researchers relied on mathematical and core econometric/regression models. <code>ggplot2</code> which is a set of <code>tidyverse</code> package is probably one of the greatest tool for data visualization used in <code>R</code>. In the following sections we are going to visualize <code>gapminder</code> data.</p>
<p>Stat graphics is a mapping of variable to <code>aes</code>thetic attributes of <code>geom</code>etric objects.</p>
<section id="essential-components-of-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="essential-components-of-ggplot2">3 Essential components of <code>ggplot2</code></h2>
<ul>
<li>data: dataset containing the variables of interest</li>
<li>geom: geometric object in question line, point, bars</li>
<li>aes: aesthetic attributes of an object x/y position, colors, shape, size</li>
</ul>
</section>
<section id="scatter-plot" class="level2">
<h2 class="anchored" data-anchor-id="scatter-plot">Scatter plot</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bubbleplot" class="level2">
<h2 class="anchored" data-anchor-id="bubbleplot">Bubbleplot</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If you just want to highlight the relationship between gbp per capita and life Expectancy you’ve probably done most of the work now. However, it is a good practice to highlight a few interesting dots in this chart to give more insight to the plot:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comparison-of-2007-vs-1952-continentwise" class="level2">
<h2 class="anchored" data-anchor-id="comparison-of-2007-vs-1952-continentwise">Comparison of 2007 vs 1952 continentwise</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gapminder_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>